<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browser Control API Tester</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .config-panel {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .config-panel h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #333;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .api-list {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
        }

        .sidebar {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .sidebar h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #333;
        }

        .api-item {
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid transparent;
        }

        .api-item:hover {
            background: #f8f9fa;
        }

        .api-item.active {
            background: #e8eaf6;
            border-left-color: #667eea;
            font-weight: 500;
        }

        .api-item .method {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 600;
            margin-right: 8px;
        }

        .method.get { background: #4caf50; color: white; }
        .method.post { background: #2196f3; color: white; }
        .method.delete { background: #f44336; color: white; }

        .api-item .path {
            font-size: 13px;
            color: #666;
        }

        .content {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .api-detail {
            display: none;
        }

        .api-detail.active {
            display: block;
        }

        .api-detail h2 {
            font-size: 22px;
            margin-bottom: 10px;
            color: #333;
        }

        .api-detail .method-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 10px;
        }

        .api-detail .path-badge {
            display: inline-block;
            padding: 4px 12px;
            background: #f5f5f5;
            border-radius: 4px;
            font-size: 12px;
            font-family: 'Courier New', monospace;
            color: #666;
        }

        .api-detail .description {
            margin: 20px 0;
            color: #666;
            font-size: 14px;
        }

        .params-section {
            margin: 25px 0;
        }

        .params-section h3 {
            font-size: 16px;
            margin-bottom: 15px;
            color: #333;
        }

        .param-item {
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
        }

        .param-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            font-size: 14px;
            color: #555;
        }

        .param-item .param-info {
            font-size: 12px;
            color: #999;
            margin-bottom: 8px;
        }

        .param-item input,
        .param-item textarea,
        .param-item select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
        }

        .param-item textarea {
            min-height: 100px;
            font-family: 'Courier New', monospace;
        }

        .param-item input[type="checkbox"] {
            width: auto;
            margin-right: 8px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .response-section {
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #eee;
        }

        .response-section h3 {
            font-size: 16px;
            margin-bottom: 15px;
            color: #333;
        }

        .response-box {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
            max-height: 500px;
            overflow-y: auto;
        }

        .response-box.success {
            border-left: 4px solid #4caf50;
        }

        .response-box.error {
            border-left: 4px solid #f44336;
        }

        .response-box.loading {
            border-left: 4px solid #ff9800;
        }

        .status-info {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 10px;
        }

        .status-200 { background: #4caf50; color: white; }
        .status-400 { background: #ff9800; color: white; }
        .status-401 { background: #f44336; color: white; }
        .status-404 { background: #f44336; color: white; }
        .status-500 { background: #f44336; color: white; }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state svg {
            width: 64px;
            height: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .copy-btn {
            float: right;
            padding: 6px 12px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
        }

        .copy-btn:hover {
            background: #5a6268;
        }

        @media (max-width: 768px) {
            .api-list {
                grid-template-columns: 1fr;
            }

            .sidebar {
                position: static;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¦ Browser Control API Tester</h1>
            <p>æµ‹è¯•æµè§ˆå™¨æ§åˆ¶æœåŠ¡å™¨çš„æ‰€æœ‰ HTTP API æ¥å£</p>
        </div>

        <div class="config-panel">
            <h2>æœåŠ¡å™¨é…ç½®</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                <div class="form-group">
                    <label>Base URL</label>
                    <input type="text" id="baseUrl" value="" placeholder="è‡ªåŠ¨æ£€æµ‹ï¼ˆå½“å‰é¡µé¢åœ°å€ï¼‰">
                    <small style="color: #999; font-size: 12px; display: block; margin-top: 4px;">ç•™ç©ºå°†è‡ªåŠ¨ä½¿ç”¨å½“å‰é¡µé¢åœ°å€</small>
                </div>
                <div class="form-group">
                    <label>Profile</label>
                    <input type="text" id="profile" value="clawd" placeholder="clawd">
                </div>
                <div class="form-group">
                    <label>Auth Token (å¯é€‰)</label>
                    <input type="text" id="authToken" placeholder="Bearer token">
                </div>
            </div>
        </div>

        <div class="api-list">
            <div class="sidebar">
                <h2>API åˆ—è¡¨</h2>
                <div id="apiList"></div>
            </div>

            <div class="content">
                <div id="apiDetails"></div>
            </div>
        </div>
    </div>

    <script>
        const apis = [
            {
                id: 'status',
                method: 'GET',
                path: '/',
                title: 'è·å–çŠ¶æ€',
                description: 'è·å–æµè§ˆå™¨æ§åˆ¶æœåŠ¡å™¨å’ŒæŒ‡å®š profile çš„çŠ¶æ€',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°' }
                ]
            },
            {
                id: 'start',
                method: 'POST',
                path: '/start',
                title: 'å¯åŠ¨æµè§ˆå™¨',
                description: 'å¯åŠ¨æŒ‡å®š profile çš„æµè§ˆå™¨å®ä¾‹ã€‚å¯ä»¥é…ç½®æµè§ˆå™¨å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ã€ç”¨æˆ·æ•°æ®ç›®å½•ã€æ— å¤´æ¨¡å¼ç­‰é€‰é¡¹ã€‚',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°ï¼ˆæŸ¥è¯¢å‚æ•°ï¼‰' },
                    { name: 'executablePath', type: 'string', required: false, default: '', description: 'æµè§ˆå™¨å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚ç¤ºä¾‹ï¼šmacOS: /Applications/Brave Browser.app/Contents/MacOS/Brave Browserï¼ŒLinux: /usr/bin/google-chromeï¼ŒWindows: C:\\Program Files\\Google\\Chrome\\Application\\chrome.exeã€‚ç•™ç©ºåˆ™è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿé»˜è®¤æµè§ˆå™¨ã€‚' },
                    { name: 'userDataDir', type: 'string', required: false, default: '', description: 'ç”¨æˆ·æ•°æ®ç›®å½•è·¯å¾„ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚æµè§ˆå™¨é…ç½®ã€ç¼“å­˜ã€Cookie ç­‰æ•°æ®å­˜å‚¨ä½ç½®ã€‚ç•™ç©ºä½¿ç”¨é»˜è®¤è·¯å¾„ï¼š~/.browser-control/browser/<profile-name>/user-data' },
                    { name: 'headless', type: 'checkbox', required: false, default: false, description: 'æ— å¤´æ¨¡å¼ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚å¯ç”¨åæµè§ˆå™¨åœ¨åå°è¿è¡Œï¼Œä¸æ˜¾ç¤ºçª—å£ã€‚' },
                    { name: 'noSandbox', type: 'checkbox', required: false, default: false, description: 'ç¦ç”¨æ²™ç®±ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚ä»…åœ¨ Docker æˆ–å—é™ç¯å¢ƒä¸­éœ€è¦æ—¶å¯ç”¨ã€‚' },
                    { name: 'cdpPort', type: 'number', required: false, default: '', description: 'CDP ç«¯å£ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚Chrome DevTools Protocol ç›‘å¬ç«¯å£ã€‚ç•™ç©ºä½¿ç”¨ profile é»˜è®¤ç«¯å£ï¼ˆé€šå¸¸ä¸º 18800+ï¼‰' }
                ]
            },
            {
                id: 'stop',
                method: 'POST',
                path: '/stop',
                title: 'åœæ­¢æµè§ˆå™¨',
                description: 'åœæ­¢æŒ‡å®š profile çš„æµè§ˆå™¨å®ä¾‹',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°' }
                ]
            },
            {
                id: 'profiles',
                method: 'GET',
                path: '/profiles',
                title: 'åˆ—å‡ºæ‰€æœ‰ Profiles',
                description: 'è·å–æ‰€æœ‰å¯ç”¨çš„ browser profiles',
                params: []
            },
            {
                id: 'tabs',
                method: 'GET',
                path: '/tabs',
                title: 'åˆ—å‡ºæ‰€æœ‰æ ‡ç­¾é¡µ',
                description: 'è·å–æŒ‡å®š profile çš„æ‰€æœ‰æ ‡ç­¾é¡µ',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°' }
                ]
            },
            {
                id: 'open-tab',
                method: 'POST',
                path: '/tabs/open',
                title: 'æ‰“å¼€æ–°æ ‡ç­¾é¡µ',
                description: 'æ‰“å¼€ä¸€ä¸ªæ–°æ ‡ç­¾é¡µå¹¶å¯¼èˆªåˆ°æŒ‡å®š URL',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°ï¼ˆæŸ¥è¯¢å‚æ•°ï¼‰' },
                    { name: 'url', type: 'string', required: true, default: 'https://example.com', description: 'è¦æ‰“å¼€çš„ URLï¼ˆè¯·æ±‚ä½“ï¼‰' }
                ]
            },
            {
                id: 'focus-tab',
                method: 'POST',
                path: '/tabs/focus',
                title: 'èšç„¦æ ‡ç­¾é¡µ',
                description: 'å°†ç„¦ç‚¹åˆ‡æ¢åˆ°æŒ‡å®šæ ‡ç­¾é¡µ',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°ï¼ˆæŸ¥è¯¢å‚æ•°ï¼‰' },
                    { name: 'targetId', type: 'string', required: true, default: '', description: 'ç›®æ ‡æ ‡ç­¾é¡µ IDï¼ˆè¯·æ±‚ä½“ï¼‰' }
                ]
            },
            {
                id: 'close-tab',
                method: 'DELETE',
                path: '/tabs/:targetId',
                title: 'å…³é—­æ ‡ç­¾é¡µ',
                description: 'å…³é—­æŒ‡å®šçš„æ ‡ç­¾é¡µ',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°ï¼ˆæŸ¥è¯¢å‚æ•°ï¼‰' },
                    { name: 'targetId', type: 'string', required: true, default: '', description: 'ç›®æ ‡æ ‡ç­¾é¡µ IDï¼ˆè·¯å¾„å‚æ•°ï¼‰' }
                ]
            },
            {
                id: 'snapshot',
                method: 'GET',
                path: '/snapshot',
                title: 'è·å–é¡µé¢å¿«ç…§',
                description: 'è·å–å½“å‰é¡µé¢çš„ AI å¿«ç…§æˆ– ARIA æ ‘',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°' },
                    { name: 'targetId', type: 'string', required: false, default: '', description: 'ç›®æ ‡æ ‡ç­¾é¡µ ID' },
                    { name: 'format', type: 'select', required: false, default: 'ai', options: ['ai', 'aria'], description: 'å¿«ç…§æ ¼å¼ï¼šai æˆ– aria' },
                    { name: 'limit', type: 'number', required: false, default: '', description: 'é™åˆ¶èŠ‚ç‚¹æ•°é‡' },
                    { name: 'maxChars', type: 'number', required: false, default: '', description: 'æœ€å¤§å­—ç¬¦æ•°' },
                    { name: 'refs', type: 'select', required: false, default: '', options: ['role', 'aria'], description: 'å¼•ç”¨ç±»å‹ï¼šrole æˆ– aria' },
                    { name: 'interactive', type: 'checkbox', required: false, default: false, description: 'ä»…è¿”å›å¯äº¤äº’å…ƒç´ ' },
                    { name: 'compact', type: 'checkbox', required: false, default: false, description: 'ç´§å‡‘æ¨¡å¼' },
                    { name: 'depth', type: 'number', required: false, default: '', description: 'æœ€å¤§æ·±åº¦' },
                    { name: 'selector', type: 'string', required: false, default: '', description: 'CSS é€‰æ‹©å™¨' },
                    { name: 'frame', type: 'string', required: false, default: '', description: 'iframe é€‰æ‹©å™¨' },
                    { name: 'labels', type: 'checkbox', required: false, default: false, description: 'åŒ…å«æ ‡ç­¾æˆªå›¾' },
                    { name: 'mode', type: 'select', required: false, default: '', options: ['efficient'], description: 'æ¨¡å¼ï¼šefficient' }
                ]
            },
            {
                id: 'screenshot',
                method: 'POST',
                path: '/screenshot',
                title: 'æˆªå›¾',
                description: 'æ•è·é¡µé¢æˆ–å…ƒç´ çš„æˆªå›¾',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°ï¼ˆæŸ¥è¯¢å‚æ•°ï¼‰' },
                    { name: 'targetId', type: 'string', required: false, default: '', description: 'ç›®æ ‡æ ‡ç­¾é¡µ IDï¼ˆè¯·æ±‚ä½“ï¼‰' },
                    { name: 'fullPage', type: 'checkbox', required: false, default: false, description: 'æ˜¯å¦å…¨é¡µæˆªå›¾ï¼ˆè¯·æ±‚ä½“ï¼‰' },
                    { name: 'ref', type: 'string', required: false, default: '', description: 'å…ƒç´ å¼•ç”¨ï¼ˆè¯·æ±‚ä½“ï¼‰' },
                    { name: 'element', type: 'string', required: false, default: '', description: 'CSS é€‰æ‹©å™¨ï¼ˆè¯·æ±‚ä½“ï¼‰' },
                    { name: 'type', type: 'select', required: false, default: 'png', options: ['png', 'jpeg'], description: 'å›¾ç‰‡ç±»å‹ï¼ˆè¯·æ±‚ä½“ï¼‰' }
                ]
            },
            {
                id: 'navigate',
                method: 'POST',
                path: '/navigate',
                title: 'å¯¼èˆª',
                description: 'å¯¼èˆªåˆ°æŒ‡å®š URL',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°ï¼ˆæŸ¥è¯¢å‚æ•°ï¼‰' },
                    { name: 'url', type: 'string', required: true, default: 'https://example.com', description: 'ç›®æ ‡ URLï¼ˆè¯·æ±‚ä½“ï¼‰' },
                    { name: 'targetId', type: 'string', required: false, default: '', description: 'ç›®æ ‡æ ‡ç­¾é¡µ IDï¼ˆè¯·æ±‚ä½“ï¼‰' }
                ]
            },
            {
                id: 'act',
                method: 'POST',
                path: '/act',
                title: 'æ‰§è¡Œæ“ä½œ',
                description: 'æ‰§è¡Œæµè§ˆå™¨æ“ä½œï¼ˆç‚¹å‡»ã€è¾“å…¥ã€æ‹–æ‹½ç­‰ï¼‰',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°ï¼ˆæŸ¥è¯¢å‚æ•°ï¼‰' },
                    { name: 'request', type: 'json', required: true, default: '{\n  "kind": "click",\n  "targetId": "",\n  "ref": "e12"\n}', description: 'æ“ä½œè¯·æ±‚ JSONï¼ˆè¯·æ±‚ä½“ï¼‰' }
                ]
            },
            {
                id: 'console',
                method: 'GET',
                path: '/console',
                title: 'è·å–æ§åˆ¶å°æ¶ˆæ¯',
                description: 'è·å–æµè§ˆå™¨æ§åˆ¶å°æ¶ˆæ¯',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°' },
                    { name: 'targetId', type: 'string', required: false, default: '', description: 'ç›®æ ‡æ ‡ç­¾é¡µ ID' },
                    { name: 'level', type: 'string', required: false, default: '', description: 'æ—¥å¿—çº§åˆ«ï¼ˆerror, warn, info, logï¼‰' }
                ]
            },
            {
                id: 'pdf',
                method: 'POST',
                path: '/pdf',
                title: 'ç”Ÿæˆ PDF',
                description: 'å°†å½“å‰é¡µé¢å¯¼å‡ºä¸º PDF',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°ï¼ˆæŸ¥è¯¢å‚æ•°ï¼‰' },
                    { name: 'targetId', type: 'string', required: false, default: '', description: 'ç›®æ ‡æ ‡ç­¾é¡µ IDï¼ˆè¯·æ±‚ä½“ï¼‰' }
                ]
            },
            {
                id: 'cookies',
                method: 'GET',
                path: '/cookies',
                title: 'è·å– Cookies',
                description: 'è·å–å½“å‰é¡µé¢çš„ Cookies',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°' },
                    { name: 'targetId', type: 'string', required: false, default: '', description: 'ç›®æ ‡æ ‡ç­¾é¡µ ID' }
                ]
            },
            {
                id: 'set-cookie',
                method: 'POST',
                path: '/cookies/set',
                title: 'è®¾ç½® Cookie',
                description: 'è®¾ç½®ä¸€ä¸ª Cookie',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°ï¼ˆæŸ¥è¯¢å‚æ•°ï¼‰' },
                    { name: 'body', type: 'json', required: true, default: '{\n  "name": "session",\n  "value": "abc123",\n  "url": "https://example.com"\n}', description: 'Cookie æ•°æ® JSONï¼ˆè¯·æ±‚ä½“ï¼‰' }
                ]
            },
            {
                id: 'clear-cookies',
                method: 'POST',
                path: '/cookies/clear',
                title: 'æ¸…é™¤ Cookies',
                description: 'æ¸…é™¤æ‰€æœ‰ Cookies',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°ï¼ˆæŸ¥è¯¢å‚æ•°ï¼‰' },
                    { name: 'targetId', type: 'string', required: false, default: '', description: 'ç›®æ ‡æ ‡ç­¾é¡µ IDï¼ˆè¯·æ±‚ä½“ï¼‰' }
                ]
            },
            {
                id: 'upload',
                method: 'POST',
                path: '/hooks/file-chooser',
                title: 'æ–‡ä»¶ä¸Šä¼ ',
                description: 'å‡†å¤‡æ–‡ä»¶é€‰æ‹©å™¨å¹¶ä¸Šä¼ æ–‡ä»¶ã€‚å¯ä»¥ç­‰å¾…æ–‡ä»¶é€‰æ‹©å™¨å‡ºç°å¹¶è‡ªåŠ¨ä¸Šä¼ ï¼Œæˆ–ç›´æ¥è®¾ç½®æ–‡ä»¶åˆ°æŒ‡å®šçš„è¾“å…¥å…ƒç´ ã€‚',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°ï¼ˆæŸ¥è¯¢å‚æ•°ï¼‰' },
                    { name: 'paths', type: 'json', required: true, default: '["/path/to/file.txt"]', description: 'æ–‡ä»¶è·¯å¾„æ•°ç»„ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚ç¤ºä¾‹ï¼š["/tmp/file1.txt", "/tmp/file2.pdf"]' },
                    { name: 'targetId', type: 'string', required: false, default: '', description: 'ç›®æ ‡æ ‡ç­¾é¡µ IDï¼ˆè¯·æ±‚ä½“ï¼‰' },
                    { name: 'ref', type: 'string', required: false, default: '', description: 'å…ƒç´ å¼•ç”¨ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚è§¦å‘æ–‡ä»¶é€‰æ‹©å™¨çš„å…ƒç´ å¼•ç”¨ï¼ˆå¦‚ e12ï¼‰ã€‚å¦‚æœæä¾›ï¼Œå°†ç‚¹å‡»è¯¥å…ƒç´ ä»¥è§¦å‘æ–‡ä»¶é€‰æ‹©å™¨' },
                    { name: 'inputRef', type: 'string', required: false, default: '', description: 'è¾“å…¥å…ƒç´ å¼•ç”¨ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚ç›´æ¥è®¾ç½®æ–‡ä»¶åˆ°æŒ‡å®šçš„è¾“å…¥å…ƒç´ å¼•ç”¨ï¼ˆä¸èƒ½ä¸ ref åŒæ—¶ä½¿ç”¨ï¼‰' },
                    { name: 'element', type: 'string', required: false, default: '', description: 'CSS é€‰æ‹©å™¨ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚ç›´æ¥è®¾ç½®æ–‡ä»¶åˆ°æŒ‡å®šçš„ CSS é€‰æ‹©å™¨å…ƒç´ ï¼ˆä¸èƒ½ä¸ ref åŒæ—¶ä½¿ç”¨ï¼‰' },
                    { name: 'timeoutMs', type: 'number', required: false, default: '', description: 'è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚ç­‰å¾…æ–‡ä»¶é€‰æ‹©å™¨å‡ºç°çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ 120000' }
                ]
            },
            {
                id: 'dialog',
                method: 'POST',
                path: '/hooks/dialog',
                title: 'å¯¹è¯æ¡†å¤„ç†',
                description: 'å‡†å¤‡å¤„ç†æµè§ˆå™¨å¯¹è¯æ¡†ï¼ˆalertã€confirmã€promptï¼‰ã€‚å½“å¯¹è¯æ¡†å‡ºç°æ—¶è‡ªåŠ¨æ¥å—æˆ–æ‹’ç»ã€‚',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°ï¼ˆæŸ¥è¯¢å‚æ•°ï¼‰' },
                    { name: 'accept', type: 'checkbox', required: true, default: true, description: 'æ˜¯å¦æ¥å—å¯¹è¯æ¡†ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚true è¡¨ç¤ºæ¥å—ï¼Œfalse è¡¨ç¤ºæ‹’ç»' },
                    { name: 'targetId', type: 'string', required: false, default: '', description: 'ç›®æ ‡æ ‡ç­¾é¡µ IDï¼ˆè¯·æ±‚ä½“ï¼‰' },
                    { name: 'promptText', type: 'string', required: false, default: '', description: 'æç¤ºæ–‡æœ¬ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚å¯¹äº prompt å¯¹è¯æ¡†ï¼Œè¦è¾“å…¥çš„æ–‡æœ¬' },
                    { name: 'timeoutMs', type: 'number', required: false, default: '', description: 'è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚ç­‰å¾…å¯¹è¯æ¡†å‡ºç°çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ 120000' }
                ]
            },
            {
                id: 'evaluate',
                method: 'POST',
                path: '/evaluate',
                title: 'æ‰§è¡Œ JavaScript',
                description: 'åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œ JavaScript ä»£ç ã€‚å¯ä»¥æ‰§è¡Œä»»æ„ JavaScript ä»£ç å¹¶è¿”å›ç»“æœã€‚å¦‚æœæä¾›äº† refï¼Œä»£ç å°†åœ¨æŒ‡å®šå…ƒç´ ä¸Šæ‰§è¡Œã€‚',
                params: [
                    { name: 'profile', type: 'string', required: false, default: 'clawd', description: 'Profile åç§°ï¼ˆæŸ¥è¯¢å‚æ•°ï¼‰' },
                    { name: 'code', type: 'json', required: true, default: '() => {\n  return document.title;\n}', description: 'è¦æ‰§è¡Œçš„ JavaScript ä»£ç ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚å¯ä»¥æ˜¯å‡½æ•°è¡¨è¾¾å¼ã€ç®­å¤´å‡½æ•°æˆ–ä»»ä½• JavaScript è¡¨è¾¾å¼ã€‚ç¤ºä¾‹ï¼š\n- () => document.title\n- () => { return window.location.href; }\n- () => document.querySelector("h1")?.textContent\n- (el) => el.textContentï¼ˆå½“æä¾› ref æ—¶ï¼Œå…ƒç´ ä½œä¸ºå‚æ•°ï¼‰' },
                    { name: 'targetId', type: 'string', required: false, default: '', description: 'ç›®æ ‡æ ‡ç­¾é¡µ IDï¼ˆè¯·æ±‚ä½“ï¼‰' },
                    { name: 'ref', type: 'string', required: false, default: '', description: 'å…ƒç´ å¼•ç”¨ï¼ˆè¯·æ±‚ä½“ï¼‰ã€‚å¦‚æœæä¾›ï¼Œä»£ç å°†åœ¨è¯¥å…ƒç´ ä¸Šæ‰§è¡Œï¼Œå…ƒç´ å°†ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å‡½æ•°ã€‚ä¾‹å¦‚ï¼šref="e12" æ—¶ï¼Œä»£ç å¯ä»¥æ¥æ”¶å…ƒç´ ä½œä¸ºå‚æ•°ï¼š(el) => el.textContent' }
                ]
            }
        ];

        let currentApi = null;

        function init() {
            renderApiList();
            if (apis.length > 0) {
                selectApi(apis[0].id);
            }
        }

        function renderApiList() {
            const listEl = document.getElementById('apiList');
            listEl.innerHTML = apis.map(api => `
                <div class="api-item" onclick="selectApi('${api.id}')" id="item-${api.id}">
                    <span class="method ${api.method.toLowerCase()}">${api.method}</span>
                    <span class="path">${api.path}</span>
                </div>
            `).join('');
        }

        function selectApi(apiId) {
            currentApi = apis.find(a => a.id === apiId);
            
            // Update sidebar
            document.querySelectorAll('.api-item').forEach(el => el.classList.remove('active'));
            document.getElementById(`item-${apiId}`).classList.add('active');
            
            renderApiDetail();
        }

        function renderApiDetail() {
            if (!currentApi) return;

            const detailEl = document.getElementById('apiDetails');
            detailEl.innerHTML = `
                <div class="api-detail active">
                    <h2>
                        <span class="method-badge ${currentApi.method.toLowerCase()}">${currentApi.method}</span>
                        <span class="path-badge">${currentApi.path}</span>
                    </h2>
                    <div class="description">${currentApi.description}</div>
                    
                    <div class="params-section">
                        <h3>å‚æ•°</h3>
                        ${renderParams()}
                    </div>
                    
                    <button class="btn btn-primary" onclick="sendRequest()">å‘é€è¯·æ±‚</button>
                    <button class="btn btn-secondary" onclick="clearResponse()" style="margin-left: 10px;">æ¸…é™¤å“åº”</button>
                    
                    <div class="response-section">
                        <h3>å“åº”ç»“æœ</h3>
                        <div id="responseBox" class="response-box"></div>
                    </div>
                </div>
            `;
        }

        function renderParams() {
            if (!currentApi.params || currentApi.params.length === 0) {
                return '<div style="color: #999; padding: 20px;">æ­¤æ¥å£æ— éœ€å‚æ•°</div>';
            }

            return currentApi.params.map(param => {
                const profile = document.getElementById('profile').value;
                const defaultValue = param.name === 'profile' ? profile : (param.default || '');
                
                let inputHtml = '';
                if (param.type === 'select') {
                    const options = param.options.map(opt => 
                        `<option value="${opt}" ${opt === param.default ? 'selected' : ''}>${opt}</option>`
                    ).join('');
                    inputHtml = `<select id="param-${param.name}" class="param-input">${options}</select>`;
                } else if (param.type === 'checkbox') {
                    inputHtml = `<label><input type="checkbox" id="param-${param.name}" class="param-input" ${param.default ? 'checked' : ''}> ${param.description}</label>`;
                } else if (param.type === 'json') {
                    inputHtml = `<textarea id="param-${param.name}" class="param-input" placeholder='${param.description}'>${defaultValue}</textarea>`;
                } else if (param.type === 'number') {
                    inputHtml = `<input type="number" id="param-${param.name}" class="param-input" value="${defaultValue}" placeholder="${param.description}">`;
                } else {
                    // For start endpoint, add helpful placeholders
                    let placeholder = param.description;
                    if (currentApi.id === 'start' && param.name === 'executablePath') {
                        if (navigator.platform.toLowerCase().includes('mac')) {
                            placeholder = '/Applications/Brave Browser.app/Contents/MacOS/Brave Browser';
                        } else if (navigator.platform.toLowerCase().includes('linux')) {
                            placeholder = '/usr/bin/google-chrome';
                        } else if (navigator.platform.toLowerCase().includes('win')) {
                            placeholder = 'C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe';
                        }
                    } else if (currentApi.id === 'start' && param.name === 'userDataDir') {
                        placeholder = '~/.browser-control/browser/clawd/user-data (ç•™ç©ºä½¿ç”¨é»˜è®¤)';
                    }
                    inputHtml = `<input type="text" id="param-${param.name}" class="param-input" value="${defaultValue}" placeholder="${placeholder}">`;
                }

                return `
                    <div class="param-item">
                        <label>${param.name} ${param.required ? '<span style="color: red;">*</span>' : ''}</label>
                        <div class="param-info">${param.description}</div>
                        ${inputHtml}
                    </div>
                `;
            }).join('');
        }

        async function sendRequest() {
            if (!currentApi) return;

            // Auto-detect base URL from current page if not set
            let baseUrl = document.getElementById('baseUrl').value.trim();
            if (!baseUrl) {
                baseUrl = window.location.origin;
                document.getElementById('baseUrl').value = baseUrl;
            }
            const authToken = document.getElementById('authToken').value.trim();
            const defaultProfile = document.getElementById('profile').value.trim();

            const responseBox = document.getElementById('responseBox');
            responseBox.className = 'response-box loading';
            responseBox.innerHTML = '<div style="color: #ff9800;">â³ å‘é€è¯·æ±‚ä¸­...</div>';

            try {
                const url = buildUrl(baseUrl, currentApi.path);
                const options = buildRequestOptions(currentApi.method, authToken, defaultProfile);

                const response = await fetch(url, options);
                const contentType = response.headers.get('content-type');
                
                let responseData;
                if (contentType && contentType.includes('application/json')) {
                    responseData = await response.json();
                } else {
                    responseData = await response.text();
                }

                const statusClass = response.ok ? 'success' : 'error';
                const statusText = response.ok ? 'âœ“ æˆåŠŸ' : 'âœ— å¤±è´¥';
                
                responseBox.className = `response-box ${statusClass}`;
                responseBox.innerHTML = `
                    <div style="margin-bottom: 15px;">
                        <strong>${statusText}</strong>
                        <span class="status-info status-${response.status}">HTTP ${response.status}</span>
                        <button class="copy-btn" onclick="copyResponse()">å¤åˆ¶</button>
                    </div>
                    <pre style="margin: 0; white-space: pre-wrap; word-wrap: break-word;">${JSON.stringify(responseData, null, 2)}</pre>
                `;
            } catch (error) {
                responseBox.className = 'response-box error';
                responseBox.innerHTML = `
                    <div style="margin-bottom: 15px;">
                        <strong>âœ— è¯·æ±‚å¤±è´¥</strong>
                        <button class="copy-btn" onclick="copyResponse()">å¤åˆ¶</button>
                    </div>
                    <pre style="margin: 0; color: #f44336;">${error.message}</pre>
                `;
            }
        }

        function buildUrl(baseUrl, path) {
            const profile = document.getElementById('profile').value.trim();
            const url = new URL(path, baseUrl);
            
            // Handle path parameters
            if (path.includes(':targetId')) {
                const targetId = document.getElementById('param-targetId')?.value.trim() || '';
                url.pathname = url.pathname.replace(':targetId', encodeURIComponent(targetId));
            }
            
            // Add query parameters
            currentApi.params.forEach(param => {
                if (param.name === 'profile' || (param.name !== 'url' && param.name !== 'targetId' && param.name !== 'request' && param.name !== 'body' && currentApi.method === 'GET')) {
                    const value = getParamValue(param.name);
                    if (value !== null && value !== '' && value !== false) {
                        url.searchParams.set(param.name, String(value));
                    }
                }
            });
            
            return url.toString();
        }

        function buildRequestOptions(method, authToken, defaultProfile) {
            const options = {
                method: method,
                headers: {}
            };

            if (authToken) {
                options.headers['Authorization'] = `Bearer ${authToken}`;
            }

            // Build body for POST/PUT/DELETE
            if (['POST', 'PUT', 'PATCH'].includes(method)) {
                const body = {};
                
                currentApi.params.forEach(param => {
                    if (param.name === 'profile') return; // Skip profile, it's in query
                    
                    const value = getParamValue(param.name);
                    
                    if (param.name === 'request' || param.name === 'body') {
                        // JSON body
                        try {
                            const jsonValue = value ? JSON.parse(value) : {};
                            Object.assign(body, jsonValue);
                        } catch (e) {
                            // If not valid JSON, treat as regular param
                            if (value !== null && value !== '' && value !== false) {
                                body[param.name] = value;
                            }
                        }
                    } else if (param.type === 'json' && param.name !== 'request' && param.name !== 'body') {
                        // JSON type param (like paths array or code string)
                        if (param.name === 'code' || param.name === 'fn') {
                            // For code/fn, treat as string (JavaScript code)
                            if (value !== null && value !== '') {
                                body[param.name] = value;
                            }
                        } else {
                            // For other JSON params, try to parse as JSON
                            try {
                                const jsonValue = value ? JSON.parse(value) : null;
                                if (jsonValue !== null) {
                                    body[param.name] = jsonValue;
                                }
                            } catch (e) {
                                // If not valid JSON, skip or use as string
                                if (value !== null && value !== '') {
                                    body[param.name] = value;
                                }
                            }
                        }
                    } else if (param.name !== 'targetId' || method !== 'DELETE') {
                        // Regular body param
                        // For start endpoint, include config params (skip empty strings, include booleans)
                        if (currentApi.id === 'start') {
                            if (param.type === 'checkbox') {
                                // Always include checkbox values (true/false)
                                body[param.name] = value === true;
                            } else if (param.type === 'number') {
                                // Include numbers only if they have a value
                                if (value !== null && value !== '') {
                                    const numValue = Number(value);
                                    if (Number.isFinite(numValue)) {
                                        body[param.name] = numValue;
                                    }
                                }
                            } else if (value !== null && value !== '') {
                                // Include non-empty strings
                                body[param.name] = value;
                            }
                        } else {
                            // For other endpoints, only include non-empty values
                            if (value !== null && value !== '' && value !== false) {
                                body[param.name] = value;
                            }
                        }
                    }
                });

                if (Object.keys(body).length > 0) {
                    options.headers['Content-Type'] = 'application/json';
                    options.body = JSON.stringify(body);
                }
            }

            return options;
        }

        function getParamValue(paramName) {
            const input = document.getElementById(`param-${paramName}`);
            if (!input) return null;

            if (input.type === 'checkbox') {
                return input.checked;
            } else if (input.tagName === 'SELECT') {
                return input.value || null;
            } else {
                return input.value.trim() || null;
            }
        }

        function clearResponse() {
            document.getElementById('responseBox').innerHTML = '';
            document.getElementById('responseBox').className = 'response-box';
        }

        function copyResponse() {
            const responseBox = document.getElementById('responseBox');
            const text = responseBox.textContent;
            navigator.clipboard.writeText(text).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'å·²å¤åˆ¶!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            });
        }

        // Auto-detect base URL on load
        window.addEventListener('DOMContentLoaded', () => {
            const baseUrlInput = document.getElementById('baseUrl');
            if (!baseUrlInput.value.trim()) {
                baseUrlInput.value = window.location.origin;
            }
        });

        // Initialize on load
        init();
    </script>
</body>
</html>
